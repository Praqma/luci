#! /usr/bin/env bats

load utils
source $LUCI_ROOT/functions/docker-functions
source $LUCI_ROOT/functions/web-functions

@test "Running Registry-UI container" {
#Build the images we need
  buildDockerImage $LUCI_ROOT/src/main/remotedocker/nginx/context luci-nginx

  $LUCI_ROOT/bin/generateRegistryCompose.sh 80 luci-nginx > $LUCI_ROOT/src/main/remotecompose/jenkins-suite-compose/docker-compose.yml

  runDockerCompose $LUCI_ROOT/src/main/remotecompose/jenkins-suite-compose/

read -p "Press [Enter] key to continue..."

  stopDockerCompose $LUCI_ROOT/src/main/remotecompose/jenkins-suite-compose/
  rm -f $LUCI_ROOT/src/main/remotecompose/jenkins-suite-compose/docker-compose.yml
}

teardown() {
    runZettaTools docker-compose stop
    cleanup_perform
}

